@model IEnumerable<OWRM_Work_Routine_Manager.Models.TarefasViewModel>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@Styles.Render("~/Content/css/Tarefa/Index.css")
@Scripts.Render("~/Scripts/Tarefa/Index.js")

<div class="row">
    <div class="container-fluid">
        <div class="row" id="box">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 barra_superior">
                <div class="btn btn-primary btn_tarefas" data-toggle="modal" data-target="#ModalAdicionarTarefa">+</div>
                <span>Clique no botão para criar uma nova tarefa</span>
            </div>
            <div class="row">
                @if (Model.Count() == 0)
                {
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 sem_dados">
                        Não existem dados a serem exibidos :(
                    </div>
                }
                else
                {
                    foreach (var item in Model)
                    {
                        <div class="card nota" style="width: 20rem;">
                            <div class="card-body">
                                <h5 class="card-title">@item.TITULO</h5>

                                <p class="card-text">
                                    @item.DESCRICAO
                                </p>

                                <div class="card_bottom">
                                    @if (item.DATA_INICIO == null && item.DATA_FIM == null)
                                    {
                                        <div class="btn_iniciar" onclick="IniciarTarefa(@item.ID_TAREFA)">
                                            Iniciar tarefa
                                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="play" class="svg-inline--fa fa-play fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"></path></svg>
                                        </div>
                                    }
                                    else if (item.DATA_INICIO != null && item.DATA_FIM == null)
                                    {
                                        <div class="row datas">
                                            <div class="col-md-6 inicio_tarefa">
                                                <span>Início da tarefa</span>
                                                @item.DATA_INICIO.Value.ToString("dd/MM/yyyy")
                                            </div>
                                            <div class="col-md-5 btn_finalizar" onclick="FinalizarTarefa(@item.ID_TAREFA)">
                                                Finalizar
                                                <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="stop" class="svg-inline--fa fa-stop fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"></path></svg>
                                            </div>
                                        </div>
                                    }
                                    else if (item.DATA_INICIO != null && item.DATA_FIM != null)
                                    {
                                        <div class="row">
                                            <div class=" col-md-6 inicio_tarefa">
                                                <span>Início da tarefa</span>
                                                @item.DATA_INICIO.Value.ToString("dd/MM/yyyy")
                                            </div>
                                            <div class=" col-md-6 fim_tarefa">
                                                <span>Fim da tarefa</span>
                                                @item.DATA_FIM.Value.ToString("dd/MM/yyyy")
                                            </div>
                                        </div>
                                    }
                                    <div class="row card_bottom_buttons">
                                        <div class="col-mds-6 btn_excluir" onclick="excluirTarefa(@item.ID_TAREFA)">
                                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="trash" class="svg-inline--fa fa-trash fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"></path></svg>
                                        </div>
                                        <div class="col-mds-6 btn_editar" onclick="EditarTarefa(@item.ID_TAREFA)" data-toggle="modal" data-target="#ModalEditarTarefa">
                                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="edit" class="svg-inline--fa fa-edit fa-w-18" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"></path></svg>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</div>

<!-- Modal criação tarefas -->
<div class="modal fade" id="ModalAdicionarTarefa" tabindex="-1" role="dialog" aria-labelledby="ModalAdicionarTarefa" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="TituloModalCentralizado">Escreva uma tarefa</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label>Insira aqui o título da sua tarefa<span class="ehobrigatorio">*</span></label>
                        <textarea class="form-control" id="tituloTarefa" rows="1"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Insira aqui a descrição da sua tarefa<span class="ehobrigatorio">*</span></label>
                        <textarea class="form-control" id="descricaoTarefa" rows="6"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="AdicionarTarefa()">Salvar</button>
                <button type="button" class="btn btn-danger" id="btnFechar" data-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal edição de tarefas -->
<div class="modal fade" id="ModalEditarTarefa" tabindex="-1" role="dialog" aria-labelledby="ModalEditarTarefa" aria-hidden="true">
    <span class="edt"></span>
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="TituloModalCentralizado">Edite sua tarefa</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label>Edite aqui o título da sua tarefa<span class="ehobrigatorio">*</span></label>
                        <textarea class="form-control" id="tituloTarefaEdt" rows="1"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Edite aqui a descrição da sua tarefa<span class="ehobrigatorio">*</span></label>
                        <textarea class="form-control" id="descricaoTarefaEdt" rows="6"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="SalvarTarefaEditada()">Salvar</button>
                <button type="button" class="btn btn-danger" id="btnFechar" data-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>